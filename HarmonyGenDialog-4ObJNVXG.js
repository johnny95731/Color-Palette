import{d as e,m as a,r as t,a as l,H as o,c as s,b as n,h as r,t as u,i,e as c,f as d,g as m,j as p,o as f,w as h,u as v,k as b,l as y,n as _,p as g,q as k,s as C,v as x,x as w,y as V,z as $,F as D,A as R,B as S,C as U,D as j,E as A,G as M,I as O,J as E,K as z,L as P,M as F,N as G,_ as H,O as L,P as B,Q as I,R as T,S as Y,T as q,U as J}from"./index-Ys1pjnKB.js";const K=["width","height"],N={class:"hex-input"},Q={class:"hsb-inputs"},X=["name","max","onUpdate:modelValue"],W=e({__name:"ColorPicker",props:a({width:{default:270},height:{default:135}},{hsb:{},hsbModifiers:{},modelValue:{},modelModifiers:{}}),emits:["update:hsb","update:modelValue"],setup(e){const a=e,j=t(),A=t(),M=t(),O=l([0,.8*o[1],.8*o[2]]),E=s({get:()=>n(r(u(O))),set(e){if(i(e)&&e!==E.value){const a=c(d(e)).map((e=>m(e,2)));Object.assign(O,a)}}}),z=s((()=>n(r([u(O)[0],o[1],o[2]])))),P=s((()=>({top:o[2]-u(O)[2]+"%",left:`${u(O)[1]}%`,backgroundColor:n(r(u(O)))}))),F=s((()=>`${p(u(O)[0],0,o[0],0,100)}%`)),G=s((()=>{var e;return null==(e=A.value)?void 0:e.getContext("2d")}));function H(){const e=u(G);if(!e)return;const{width:t,height:l}=a;e.clearRect(0,0,+t,+l),e.fillStyle=u(z),e.fillRect(0,0,+t,+l);const o=e.createLinearGradient(0,0,+t,0);o.addColorStop(0,"rgba(255,255,255,1)"),o.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=o,e.fillRect(0,0,+t,+l);const s=e.createLinearGradient(0,0,0,+l);s.addColorStop(0,"rgba(0,0,0,0)"),s.addColorStop(1,"rgba(0,0,0,1)"),e.fillStyle=s,e.fillRect(0,0,+t,+l)}f(H),h(z,H);const L=(()=>{let e=0,a=[];const{rect:t,update:l}=v(A),s=e=>{const a=m(p(e.clientX,t.left,t.right,0,o[1]),2);u(O)[1]=a;const l=m(p(e.clientY,t.top,t.bottom,o[2],0),2);u(O)[2]=l};function n(a){if(e)return s(a),0}function r(){e=0,a.forEach((e=>e()))}return function(t){t.preventDefault(),a=[U("mousemove",n,{capture:1}),U("mouseup",r,{capture:1})],l(),s(t),e=1}})(),B=(()=>{let e=0,a=[];const{rect:t,update:l}=v(M,{filter:["top","bottom"]}),s=e=>{const a=m(p(e.clientY,t.top,t.bottom,0,o[0]),2);u(O)[0]=a};function n(a){if(e)return s(a),0}function r(){e=0,a.forEach((e=>e()))}return function(t){t.preventDefault(),a=[U("mousemove",n,{capture:1}),U("mouseup",r,{capture:1})],l(),s(t),e=1}})(),I=b(e,"hsb"),T=b(e,"modelValue");return(()=>{const e=y(u(I)),a=y(u(T));e&&!a?Object.assign(O,c(d(u(T)))):!e&&a&&Object.assign(O,u(I))})(),h(O,(e=>{I.value=e,T.value=u(P).backgroundColor}),{deep:1,immediate:1}),h(I,(e=>Object.assign(O,u(e).map((e=>m(e,2))))),{deep:1}),h(T,(e=>{e!==u(E)&&Object.assign(O,c(d(u(e))).map((e=>m(e,2))))})),(e,a)=>(_(),g("div",{ref_key:"containerRef",ref:j,class:"color-picker-container"},[k("div",{ref_key:"containerRef",ref:j,class:"pickers"},[k("div",{class:"color-picker",onMousedown:a[0]||(a[0]=(...e)=>C(L)&&C(L)(...e))},[k("canvas",{ref_key:"colorPickerCanvasRef",ref:A,width:e.width,height:e.height},null,8,K),k("div",{class:"color-pointer",style:x(P.value)},null,4)],32),k("div",{class:"hue-picker",onMousedown:a[1]||(a[1]=(...e)=>C(B)&&C(B)(...e))},[k("div",{ref_key:"hueTrackRef",ref:M,class:"hue-track"},null,512),k("div",{class:"hue-pointer",style:x({top:F.value,backgroundColor:z.value})},null,4)],32)],512),k("label",N,[a[3]||(a[3]=w(" Hex ")),V(k("input",{name:"color-piker-hex",maxlength:"7",size:"7","onUpdate:modelValue":a[2]||(a[2]=e=>E.value=e)},null,512),[[$,E.value,void 0,{lazy:1}]])]),k("div",Q,[(_(),g(D,null,R([["hue","色調"],["sat","彩度"],["bri","亮度"]],(([e,a],t)=>k("label",{key:e},[w(S(a)+" ",1),V(k("input",{name:`color-piker-${e}`,type:"number",inputmode:"decimal",min:"0",max:C(o)[t],step:"any","onUpdate:modelValue":e=>O[t]=e},null,8,X),[[$,O[t],void 0,{lazy:1}]])]))),64))])],512))}}),Z=["min","max"],ee=((e,a)=>{const t=e.__vccOpts||e;for(const[l,o]of a)t[l]=o;return t})(e({__name:"HarmonyGenDialog",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:["update:modelValue"],setup(e){const a=b(e,"modelValue"),u=j(),i=t([[]]),c=()=>{i.value=u.cards.map((e=>e.color))};h(a,(()=>{A(a)?c():u.setPlt(A(i))}));const d=t([0,.85*o[1],.85*o[2]]),m=l({method:0,num:6}),p=s((()=>M(O[m.method])([...A(d)],m.num).map((e=>n(r(e)))))),f=()=>{u.setPlt(A(p))},v=()=>{f(),c(),J(a)};return(e,t)=>(_(),E(q,{"content-class":e.$style.genDialog,role:"dialog",eager:1,transition:"slide-y",transparent:"",modelValue:a.value,"onUpdate:modelValue":t[5]||(t[5]=e=>a.value=e)},{default:z((()=>[t[0]||(P(-1),(t[0]=k("header",{class:F(e.$style.header)},[t[6]||(t[6]=k("h2",null,"調和調色盤",-1)),G(H,{icon:"close","aria-label":"close",onClick:e=>a.value=0},null,8,["onClick"])],2)).cacheIndex=0,P(1),t[0]),k("div",{class:F(e.$style.content)},[k("div",{class:F(e.$style.palette)},[(_(1),g(D,null,R(p.value,(e=>(_(),g("div",{key:e,style:x({background:e})},null,4)))),128))],2),G(W,{hsb:d.value,"onUpdate:hsb":t[1]||(t[1]=e=>d.value=e)},null,8,["hsb"]),G(L,{options:C(O),index:m.method,"onUpdate:index":t[2]||(t[2]=e=>m.method=e)},null,8,["options","index"]),1<=m.method&&m.method<=3?B([m],(()=>(_(),g("div",{key:0,class:F(e.$style.numbers)},[t[7]||(t[7]=k("label",{for:"harmony-num"},"數量",-1)),V(k("input",{id:"harmony-num",name:"harmony-num",type:"number",min:C(I),max:C(T),"onUpdate:modelValue":t[3]||(t[3]=e=>m.num=e)},null,8,Z),[[$,m.num,void 0,{lazy:1,number:1}]])],2))),t,4):Y("",1),t[10]||(t[10]=k("div",{class:"spacer"},null,-1)),k("div",{class:F(e.$style.buttons)},[G(H,{onClick:f},{default:z((()=>t[8]||(t[8]=[w(" 預覽 ")]))),_:1}),G(H,{onClick:v},{default:z((()=>t[9]||(t[9]=[w(" 確定 ")]))),_:1})],2)],2)])),_:1},8,["content-class","modelValue"]))}}),[["__cssModules",{$style:{color1:"#FAFAFA",color2:"#EAEAEA",color3:"#C0C0C0",color4:"#707070",color5:"#1D1D57",genDialog:"_genDialog_w9dvy_9",header:"_header_w9dvy_21",content:"_content_w9dvy_42",palette:"_palette_w9dvy_52",numbers:"_numbers_w9dvy_68",buttons:"_buttons_w9dvy_80"}}]]);export{ee as default};
