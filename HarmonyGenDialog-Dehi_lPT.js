import{d as e,u as a,r as l,w as n,o,C as s,a as t,H as r,c,h as d,i,b as u,e as m,f as p,g as _,m as k,p as f,t as h,j as v,k as b,l as y,n as g,q as x,s as V,v as w,x as F,y as U,z as S,_ as C,A as M,B as P,D as T,F as B,E as z,G as $,I as R,J as j,K as D,L as E,M as H,N as O,O as G,P as q,Q as A,R as I,S as J,T as K,U as L,V as N,W as Q,X as W,Y as X,Z as Y,$ as Z,a0 as ee,a1 as ae,a2 as le}from"./index-CVo0TAsf.js";const ne={class:"color-picker__pickers"},oe={class:"color-picker__canvas"},se={key:0,class:"color-picker__mask"},te={class:"color-picker__edits"},re={class:"color-picker__hex-input"},ce={class:"color-picker__hsb-inputs"},de=["name","max","onUpdate:modelValue"],ie={class:"color-picker__variants"},ue=e({__name:"ColorPicker",props:{show:{type:Boolean,default:!1},showModifiers:{},modelValue:{},modelModifiers:{}},emits:["update:show","update:modelValue"],setup(e){const q=a(e,"show"),A=l("wheel"),I=l(),J=l(),K=l(),L=l(0),N=()=>{var e;"wheel"===u(A)&&J.value?L.value=H(O(null==(e=I.value)?void 0:e.contentRef,"--wheel-width")/(2*s),2):L.value=0};n(A,(()=>N()),{flush:"post"}),o((()=>{I.value.contentRef.style.setProperty("--canvas-size",`${s}px`),N()}));const Q=t([0,r[1],r[2]]),W=(e,a=!0)=>{let l="string"==typeof(e=u(e))?G(e):e;a&&(l=l.map((e=>p(e,2)))),Object.assign(Q,l)},X=c({get:()=>d(Q),set(e){e!==X.value&&i(e)&&W(e)}}),Y=c((()=>d([Q[0],r[1],r[2]]))),Z=t({top:"0",left:"0",background:""}),ee=c((()=>({background:`linear-gradient(0deg, #000, #0000), linear-gradient(90deg, #ffff, #fff0), ${Y.value}`}))),ae=l({}),le=c((()=>"rect"===u(A)?{l:e=>{Q[1]=m(e.x,0,100,0,r[1],2),Q[2]=m(e.y,0,100,r[2],0,2)},o:()=>({top:r[2]-Q[2]+"%",left:Q[1]+"%",background:d(Q)}),t:e=>{Q[0]=p(e,2)},i:()=>({background:Y.value})}:"rounded"===u(A)?{l:e=>{const{deg:a,radius:l}=_(m(e.y,0,100,-1,1,4),m(e.x,0,100,-1,1,4));Q[0]=k(a+90,360),Q[1]=m(l,0,1,0,r[1],2)},o:()=>{const{x:e,y:a}=f(Q[1],Q[0]-90,2);return{top:m(a,-r[1],r[1],0,100,1)+"%",left:m(e,-r[1],r[1],0,100,1)+"%",background:d(Q)}},t:e=>{Q[2]=p(e,2)},i:()=>({background:d([0,0,Q[2]])})}:{l:e=>{const{deg:a}=_(m(e.y,0,100,-1,1,4),m(e.x,0,100,-1,1,4),2);Q[0]=k(a+90,360)},o:()=>{const{x:e,y:a}=f(50-L.value,Q[0]-90);return{top:a+50+"%",left:e+50+"%",background:Y.value}},u:e=>{Q[1]=m(e.x,0,100,0,r[1],2),Q[2]=m(e.y,0,100,r[2],0,2)},i:()=>({left:m(Q[1],0,r[1],0,100,2)+"%",top:m(Q[2],0,r[2],100,0,2)+"%",background:X.value})})),ue={};o((()=>{var e;const a=null==(e=J.value)?void 0:e.getContext("2d"),l=a.createLinearGradient(0,0,s,0);l.addColorStop(0,"#fff"),l.addColorStop(1,"#fff0"),ue.m=l;const n=a.createLinearGradient(0,0,0,s);n.addColorStop(0,"#0000"),n.addColorStop(1,"#000"),ue.p=n;const o=a.createConicGradient(-Math.PI/2,s/2,s/2),t=["#f00","#ff0","#0f0","#0ff","#00f","#f0f","#f00"];t.forEach(((e,a)=>o.addColorStop(a/(t.length-1),e))),ue._=o}));const me=()=>{var e;const a=null==(e=J.value)?void 0:e.getContext("2d");a&&a.clearRect(0,0,s,s)},pe=e=>{var a;const l=null==(a=J.value)?void 0:a.getContext("2d");l&&(l.fillStyle=u(e),l.fillRect(0,0,s,s))},_e=c((()=>{var e;const a=null==(e=J.value)?void 0:e.getContext("2d");return"rect"===u(A)?()=>{me(),pe(Y),pe(ue.m),pe(ue.p)}:"rounded"===u(A)?()=>{me(),pe(ue._),pe("#000000"+m(Q[2],0,r[2],255,0,0).toString(16));const e=s/2,l=a.createRadialGradient(e,e,0,e,e,e),n=d([0,0,Q[2]]);l.addColorStop(0,n),l.addColorStop(1,n+"00"),pe(l)}:(me(),pe(ue._),null)})),ke=()=>{var e;Object.assign(Z,le.value.o()),ae.value=le.value.i(),null==(e=_e.value)||e.call(_e)};n((()=>[u(A),Q]),ke,{deep:!0,flush:"post"}),o(ke);const fe=h((()=>{const e=e=>{le.value.l(e)},{start:a}=v(J,{containerElement:J,onStart:e,onMove:e});return a})),he=h((()=>{const e=e=>{le.value.u(e)},{start:a}=v(K,{containerElement:K,onStart:e,onMove:e});return a})),ve=a(e,"modelValue");return b(u(ve))||W(ve,!1),n(Q,(e=>{ve.value=e}),{immediate:!0}),n(ve,(e=>W(e)),{deep:!0}),(e,a)=>(y(),g(E,{ref_key:"containerRef",ref:I,role:"dialog",eager:!0,transition:"slide-y",transparent:"","content-class":["color-picker",`color-picker--${A.value}`],modelValue:q.value,"onUpdate:modelValue":a[7]||(a[7]=e=>q.value=e)},{default:x((()=>[V("div",ne,[V("div",oe,[a[0]||(w(-1),(a[0]=V("canvas",{ref_key:"canvasPickerRef",ref:J,width:u(s),height:u(s)},null,8,["width","height"])).cacheIndex=0,w(1),a[0]),"wheel"===A.value?(y(),F("div",se)):U("",!0),V("div",{class:"color-picker__thumb",style:S(Z),onPointerdown:a[1]||(a[1]=(...e)=>u(fe)&&u(fe)(...e))},null,36)]),"wheel"!==A.value?(y(),g(C,{key:0,showRange:!1,min:"0",max:"rect"===A.value?u(r)[0]:u(r)[2],trackerBackground:"rect"===A.value?"linear-gradient(to right, #F00, #FF0, #0F0, #0FF, #00F, #F0F, #F00)":"linear-gradient(to right, #000, #fff)",thumbBackground:ae.value.background,"model-value":"rect"===A.value?Q[0]:Q[2],"onUpdate:modelValue":le.value.t},null,8,["max","trackerBackground","thumbBackground","model-value","onUpdate:modelValue"])):(y(),F("div",{key:1,ref_key:"secondPickerRef",ref:K,class:"color-picker__rect-picker",style:S(ee.value)},[V("div",{class:"color-picker__thumb",rectPickerThumeStyle:"",style:S(ae.value),onPointerdown:a[2]||(a[2]=(...e)=>u(he)&&u(he)(...e))},null,36)],4))]),V("div",te,[V("div",{class:"color-picker__preview",style:S({background:X.value})},null,4),V("label",re,[a[8]||(a[8]=M(" Hex ")),P(V("input",{name:"color-piker-hex",maxlength:"7",size:"7","onUpdate:modelValue":a[3]||(a[3]=e=>X.value=e)},null,512),[[T,X.value,void 0,{lazy:!0}]])]),V("div",ce,[(y(),F(B,null,z([["hue","色調"],["sat","彩度"],["bri","亮度"]],(([e,a],l,n,o)=>{const s=[Q[l]];if(o&&o.key===e&&$(o,s))return o;const t=(y(),F("label",{key:e},[M(R(a)+" ",1),P(V("input",{name:`color-piker-${e}`,type:"number",inputmode:"decimal",min:"0",max:u(r)[l],step:"any","onUpdate:modelValue":e=>Q[l]=e},null,8,de),[[T,Q[l],void 0,{lazy:!0}]])]));return t.memo=s,t}),a,4),64))]),V("div",ie,[a[9]||(a[9]=M(" 樣式 ")),j(D,{items:["rect","rounded","wheel"],modelValue:A.value,"onUpdate:modelValue":a[6]||(a[6]=e=>A.value=e)},null,8,["modelValue"])])])])),k:1},8,["content-class","modelValue"]))}}),me=["min","max"],pe=((e,a)=>{const l=e.__vccOpts||e;for(const[n,o]of a)l[n]=o;return l})(e({__name:"HarmonyGenDialog",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:["update:modelValue"],setup(e){const o=a(e,"modelValue"),s=l(!1),d=q(),i=l([0,r[1],r[2]]),m=t({method:0,num:6}),p=c((()=>A(I[m.method])([...u(i)],m.num).map((e=>J(K(e)))))),_=l(!0),k=()=>{d.setPlt(u(_)?u(p):u(h))};n((()=>[u(_),u(p)]),k);const f=()=>{d.setPlt(u(p)),v(),le(o)},h=l([[]]),v=()=>{h.value=d.cards.map((e=>e.color))};return n(o,(e=>{e?(v(),k()):d.setPlt(u(h))}),{immediate:!0}),(e,a)=>(y(),g(E,{"content-class":e.$style.genDialog,role:"dialog",eager:!0,transition:"slide-y",transparent:"",modelValue:o.value,"onUpdate:modelValue":a[12]||(a[12]=e=>o.value=e)},{default:x((()=>[a[0]||(w(-1),(a[0]=V("header",{class:L(e.$style.header)},[a[13]||(a[13]=V("h2",null,"調和調色盤",-1)),j(N,{icon:"x-lg","aria-label":"關閉",onClick:e=>o.value=!1},null,8,["onClick"])],2)).cacheIndex=0,w(1),a[0]),V("div",{class:L(e.$style.content)},[Q(p.value,(()=>(y(),F("div",{class:L(e.$style.palette)},[(y(!0),F(B,null,z(p.value,((e,a)=>(y(),g(N,{key:a,style:S({background:e}),ripple:!1,onClick:e=>{return l=a,void ae(u(p)[l]);var l}},null,8,["style","onClick"])))),128))],2))),a,1),Q([p.value[0]],(()=>j(N,{style:S({color:u(W)(u(X)(p.value[0]))>127?"#000":"#FFF",background:p.value[0]}),"prepend-icon":"eyedropper",text:"開啟color picker",onClick:a[2]||(a[2]=e=>s.value=!s.value)},null,8,["style"])),a,3),j(ue,{modelValue:i.value,"onUpdate:modelValue":a[4]||(a[4]=e=>i.value=e),show:s.value,"onUpdate:show":a[5]||(a[5]=e=>s.value=e)},null,8,["modelValue","show"]),V("div",null,[a[14]||(a[14]=M(" 調和方法 ")),j(D,{items:u(I),index:m.method,"onUpdate:index":a[6]||(a[6]=e=>m.method=e)},null,8,["items","index"])]),1<=m.method&&m.method<=3?Q([m],(()=>(y(),F("div",{key:0,class:L(e.$style.numbers)},[a[15]||(a[15]=V("label",{for:"harmony-num"},"數量",-1)),P(V("input",{id:"harmony-num",name:"harmony-num",type:"number",min:u(Y),max:u(Z),"onUpdate:modelValue":a[7]||(a[7]=e=>m.num=e)},null,8,me),[[T,m.num,void 0,{lazy:!0,number:!0}]])],2))),a,8):U("",!0),a[9]||(w(-1),(a[9]=V("div",{class:"spacer"})).cacheIndex=9,w(1),a[9]),V("div",{class:L(e.$style.buttons)},[V("label",null,[P(V("input",{type:"checkbox",name:"preview","onUpdate:modelValue":a[10]||(a[10]=e=>_.value=e)},null,512),[[ee,_.value]]),a[16]||(a[16]=M(" 預覽 "))]),a[11]||(w(-1),(a[11]=j(N,{onClick:f,text:"確定"})).cacheIndex=11,w(1),a[11])],2)],2)])),k:1},8,["content-class","modelValue"]))}}),[["__cssModules",{$style:{genDialog:"_genDialog_bxunp_1",header:"_header_bxunp_10",content:"_content_bxunp_34",palette:"_palette_bxunp_48",numbers:"_numbers_bxunp_63",buttons:"_buttons_bxunp_73"}}]]);export{pe as default};
