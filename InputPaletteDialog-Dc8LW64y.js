import{d as e,u as a,r as l,a as n,b as s,w as o,c as t,m as i,e as c,o as d,f as r,g as u,n as p,h as f,_,i as m,F as y,j as g,k as v,l as b,t as k,p as h,q as w,s as x,M as C,v as V,x as B,y as D,z as I,A as M,B as z,C as E,D as U,E as $,G as j,H as K,I as P}from"./index-nV7RSONP.js";const q={settingDialog:"_settingDialog_8a5a1e4",header:"_header_488e684",content:"_content_1d48abc",palette:"_palette_6a94ee2",color:"_color_0327467",buttons:"_buttons_5dafbf4",applyBtn:"_applyBtn_d410fb5",preview:"_preview_6310160"},A=["for"],F=["id","value","onChange","onKeydown"],G=["onUpdate:modelValue"],H=e({__name:"InputPaletteDialog",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:["update:modelValue"],setup(e){const H=a(e,"modelValue"),R=l(!0),S=n(),J=l([]),L=l([]),N=l(),O=l({top:0,zIndex:1}),Q=l(null),T=l(null),{start:W}=(()=>{let e=null,a=null;const l=e=>P(Math.floor(e.y/100*L.value.length),0,L.value.length-1),n=a=>{M(e)||(O.value.top=a.y-e+"%")};return s(N,{containerElement:N,binding:!1,onStart:s=>{Q.value=l(s),a=100/L.value.length,e=a*(Q.value+.5),n(s)},onMove:a=>{M(Q)||M(e)||(n(a),T.value=l(a))},onEnd:()=>{if(!M(Q)){if(Q.value!==T.value&&!M(T.value)){const e=L.value.splice(Q.value,1)[0];L.value.splice(T.value,0,e)}Q.value=null,T.value=null,O.value.top=0}}})})(),X=()=>{S.l(t(R)?t(L):t(J))},Y=()=>{S.l(t(L)),Z(),z(H)},Z=()=>{J.value=i(S.o,(e=>e.t))};o((()=>[t(R),t(L)]),X,{deep:!0}),o(H,(e=>{e?(L.value=i(S.o,(e=>e.t)),Z(),X()):S.l(t(J))}),{immediate:!0});const ee=()=>{L.value.push(U($()))};return(e,a)=>(d(),c(I,{"content-class":t(q).settingDialog,role:"dialog",eager:!0,transition:"slide-y",transparent:"",modelValue:H.value,"onUpdate:modelValue":a[7]||(a[7]=e=>H.value=e)},{default:r((()=>[u("header",{class:p(t(q).header)},[a[8]||(a[8]=u("h2",null,"輸入調色盤",-1)),f(_,{icon:"x-lg","aria-label":"close",onClick:a[0]||(a[0]=e=>H.value=!1)})],2),u("div",{class:p(t(q).content)},[u("div",{ref_key:"contentRef",ref:N,class:p(t(q).palette)},[(d(!0),m(y,null,g(L.value,((e,l)=>(d(),m("div",{key:l,class:p(t(q).color),style:v(l===Q.value&&O.value)},[f(_,{icon:"list",onPointerdown:a[1]||(a[1]=e=>t(W)(e))}),u("label",{for:`color${l+1}`,style:v({background:e,color:e})},k(`color${l+1}`),13,A),u("input",{id:`color${l+1}`,maxlength:"7",size:"7",value:e,onInput:a[2]||(a[2]=e=>t(h)(e)),onChange:e=>function(e,a){const l=e.currentTarget.value;l!==L.value[a]&&E(l)&&(L.value[a]=l)}(e,l),onKeydown:e=>(async(e,a)=>{if(j(e)&&"v"===e.key.toLowerCase()){const e=await K();if(e){const l=[];for(const a of e.split("-"))E(a)&&l.push(a.startsWith("#")?a:"#"+a);do{L.value.splice(a++,1,l.shift())}while(a<C&&l.length);a<L.value.length&&L.value.splice(a,L.value.length-a)}}})(e,l)},null,40,F),L.value.length>2?(d(),c(_,{key:0,icon:"x-lg","aria-label":"移除",onClick:e=>{return a=l,void L.value.splice(a,1);var a}},null,8,["onClick"])):b("",!0),l!==Q.value&&l===T.value?(d(),c(w,{key:1,type:"arrow-left"})):b("",!0)],6)))),128))],2),a[3]||(x(-1),(a[3]=u("div",{class:"spacer"})).cacheIndex=3,x(1),a[3]),u("div",{class:p(t(q).buttons)},[f(_,{style:{"align-self":"center"},"prepend-icon":"plus",text:"新增",disabled:L.value.length===t(C),onClick:ee},null,8,["disabled"]),a[4]||(x(-1),(a[4]=u("div",{class:"spacer"})).cacheIndex=4,x(1),a[4]),a[5]||(x(-1),(a[5]=u("label",null,[V(u("input",{type:"checkbox",name:"preview","onUpdate:modelValue":e=>R.value=e},null,8,G),[[D,R.value]]),a[9]||(a[9]=B(" 預覽 "))])).cacheIndex=5,x(1),a[5]),a[6]||(x(-1),(a[6]=f(_,{text:"確定",onClick:Y})).cacheIndex=6,x(1),a[6])],2)],2)])),i:1},8,["content-class","modelValue"]))}});export{H as default};
