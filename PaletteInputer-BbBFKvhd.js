import{d as e,b as a,r as l,u as o,K as n,w as s,e as t,L as i,h as r,o as d,j as u,q as c,l as p,m as f,F as m,D as _,H as y,k as v,p as k,_ as b,B as V,z as x,N as g,O as w,s as h,y as C,t as I,P,Q as U,J as j,R as z,S as K,T as M,U as $,V as B,W as D}from"./index-zpM2CxNx.js";import{_ as E}from"./VDialog.vue_vue_type_style_index_0_lang-DyO6QSbf.js";const R={paletteInputer:"_paletteInputer_6f61c2f",palette:"_palette_b9e91ad",color:"_color_f1c9a85"},S=["for"],q=["id","value","onChange","onKeydown"],F=["onUpdate:modelValue"],H=e({__name:"PaletteInputer",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:["update:modelValue"],setup(e){const H=a(e,"modelValue"),J=l(!0),L=o(),N=l([]),O=l([]),Q=l(),T=l({top:0,zIndex:1}),W=l(null),A=l(null),{start:G}=(()=>{let e=null,a=null;const l=e=>D(Math.floor(e.y/100*O.value.length),0,O.value.length-1),o=a=>{B(e)||(T.value.top=a.y-e+"%")};return n(Q,{containerElement:Q,binding:!1,onStart:n=>{W.value=l(n),a=100/O.value.length,e=a*(W.value+.5),o(n)},onMove:a=>{B(W)||B(e)||(o(a),A.value=l(a))},onEnd:()=>{if(!B(W)){if(W.value!==A.value&&!B(A.value)){const e=O.value.splice(W.value,1)[0];O.value.splice(A.value,0,e)}W.value=null,A.value=null,T.value.top=0}}})})(),X=()=>{L.l(t(J)?t(O):t(N))},Y=()=>{L.l(t(O)),Z(),U(H)},Z=()=>{N.value=i(L.o,(e=>e.t))};s((()=>[t(J),t(O)]),X,{deep:!0}),s(H,(e=>{e?(O.value=i(L.o,(e=>e.t)),Z(),X()):L.l(t(N))}),{immediate:!0});const ee=()=>{O.value.push(z(K()))};return(e,a)=>(d(),r(E,{overlayProps:{contentClass:t(R).paletteInputer},title:"輸入調色盤",modelValue:H.value,"onUpdate:modelValue":a[5]||(a[5]=e=>H.value=e)},{actions:u((()=>[v(b,{"prepend-icon":"plus",text:"新增",disabled:O.value.length===t(w),onClick:ee},null,8,["disabled"]),a[2]||(h(-1),(a[2]=c("div",{class:"spacer"})).cacheIndex=2,h(1),a[2]),a[3]||(h(-1),(a[3]=c("label",null,[C(c("input",{type:"checkbox",name:"preview","onUpdate:modelValue":e=>J.value=e},null,8,F),[[P,J.value]]),a[6]||(a[6]=I(" 預覽 "))])).cacheIndex=3,h(1),a[3]),a[4]||(h(-1),(a[4]=v(b,{text:"確定",onClick:Y})).cacheIndex=4,h(1),a[4])])),default:u((()=>[c("div",{ref_key:"contentRef",ref:Q,class:p(t(R).palette)},[(d(!0),f(m,null,_(O.value,((e,l)=>(d(),f("div",{key:l,class:p(t(R).color),style:y(l===W.value&&T.value)},[v(b,{icon:"list",onPointerdown:a[0]||(a[0]=e=>t(G)(e))}),c("label",{for:`color${l+1}`,style:y({background:e,color:e})},V(`color${l+1}`),13,S),c("input",{id:`color${l+1}`,maxlength:"7",size:"7",value:e,onInput:a[1]||(a[1]=e=>t(x)(e)),onChange:e=>function(e,a){const l=e.currentTarget.value;l!==O.value[a]&&j(l)&&(O.value[a]=l)}(e,l),onKeydown:e=>(async(e,a)=>{if(M(e)&&"v"===e.key.toLowerCase()){const e=await $();if(e){const l=[];for(const a of e.split("-"))j(a)&&l.push(a.startsWith("#")?a:"#"+a);do{O.value.splice(a++,1,l.shift())}while(a<w&&l.length);a<O.value.length&&O.value.splice(a,O.value.length-a)}}})(e,l)},null,40,q),O.value.length>2?(d(),r(b,{key:0,icon:"x-lg","aria-label":"移除",onClick:e=>{return a=l,void O.value.splice(a,1);var a}},null,8,["onClick"])):k("",!0),l!==W.value&&l===A.value?(d(),r(g,{key:1,type:"arrow-left"})):k("",!0)],6)))),128))],2)])),i:1},8,["overlayProps","modelValue"]))}});export{H as default};
