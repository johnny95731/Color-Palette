import{d as e,u as a,r as l,a as o,b as n,w as s,c as t,m as i,e as r,o as d,f as u,g as c,n as p,h as m,F as f,i as _,j as y,k as v,l as k,_ as b,t as x,p as g,q as V,M as w,s as C,v as h,x as I,y as M,z as j,A as z,B as E,C as P,D as U,E as $,G as B,H as D}from"./index-BgjYmmsO.js";import{_ as K}from"./VDialog.vue_vue_type_style_index_0_lang-_Z0gx2Aj.js";const q={paletteInputer:"_paletteInputer_9008636",palette:"_palette_30dc418",color:"_color_f2bea92"},A=["for"],F=["id","value","onChange","onKeydown"],G=["onUpdate:modelValue"],H=e({__name:"paletteInputer",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:["update:modelValue"],setup(e){const H=a(e,"modelValue"),R=l(!0),S=o(),J=l([]),L=l([]),N=l(),O=l({top:0,zIndex:1}),Q=l(null),T=l(null),{start:W}=(()=>{let e=null,a=null;const l=e=>D(Math.floor(e.y/100*L.value.length),0,L.value.length-1),o=a=>{j(e)||(O.value.top=a.y-e+"%")};return n(N,{containerElement:N,binding:!1,onStart:n=>{Q.value=l(n),a=100/L.value.length,e=a*(Q.value+.5),o(n)},onMove:a=>{j(Q)||j(e)||(o(a),T.value=l(a))},onEnd:()=>{if(!j(Q)){if(Q.value!==T.value&&!j(T.value)){const e=L.value.splice(Q.value,1)[0];L.value.splice(T.value,0,e)}Q.value=null,T.value=null,O.value.top=0}}})})(),X=()=>{S.l(t(R)?t(L):t(J))},Y=()=>{S.l(t(L)),Z(),z(H)},Z=()=>{J.value=i(S.o,(e=>e.t))};s((()=>[t(R),t(L)]),X,{deep:!0}),s(H,(e=>{e?(L.value=i(S.o,(e=>e.t)),Z(),X()):S.l(t(J))}),{immediate:!0});const ee=()=>{L.value.push(P(U()))};return(e,a)=>(d(),r(K,{overlayProps:{contentClass:t(q).paletteInputer},title:"輸入調色盤",modelValue:H.value,"onUpdate:modelValue":a[5]||(a[5]=e=>H.value=e)},{actions:u((()=>[v(b,{"prepend-icon":"plus",text:"新增",disabled:L.value.length===t(w),onClick:ee},null,8,["disabled"]),a[2]||(C(-1),(a[2]=c("div",{class:"spacer"})).cacheIndex=2,C(1),a[2]),a[3]||(C(-1),(a[3]=c("label",null,[h(c("input",{type:"checkbox",name:"preview","onUpdate:modelValue":e=>R.value=e},null,8,G),[[M,R.value]]),a[6]||(a[6]=I(" 預覽 "))])).cacheIndex=3,C(1),a[3]),a[4]||(C(-1),(a[4]=v(b,{text:"確定",onClick:Y})).cacheIndex=4,C(1),a[4])])),default:u((()=>[c("div",{ref_key:"contentRef",ref:N,class:p(t(q).palette)},[(d(!0),m(f,null,_(L.value,((e,l)=>(d(),m("div",{key:l,class:p(t(q).color),style:y(l===Q.value&&O.value)},[v(b,{icon:"list",onPointerdown:a[0]||(a[0]=e=>t(W)(e))}),c("label",{for:`color${l+1}`,style:y({background:e,color:e})},x(`color${l+1}`),13,A),c("input",{id:`color${l+1}`,maxlength:"7",size:"7",value:e,onInput:a[1]||(a[1]=e=>t(g)(e)),onChange:e=>function(e,a){const l=e.currentTarget.value;l!==L.value[a]&&E(l)&&(L.value[a]=l)}(e,l),onKeydown:e=>(async(e,a)=>{if($(e)&&"v"===e.key.toLowerCase()){const e=await B();if(e){const l=[];for(const a of e.split("-"))E(a)&&l.push(a.startsWith("#")?a:"#"+a);do{L.value.splice(a++,1,l.shift())}while(a<w&&l.length);a<L.value.length&&L.value.splice(a,L.value.length-a)}}})(e,l)},null,40,F),L.value.length>2?(d(),r(b,{key:0,icon:"x-lg","aria-label":"移除",onClick:e=>{return a=l,void L.value.splice(a,1);var a}},null,8,["onClick"])):k("",!0),l!==Q.value&&l===T.value?(d(),r(V,{key:1,type:"arrow-left"})):k("",!0)],6)))),128))],2)])),i:1},8,["overlayProps","modelValue"]))}});export{H as default};
