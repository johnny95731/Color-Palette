import{d as e,f as u,r as a,u as l,L as Q,c as d,h as p,w as m,m as t,i as v,o as f,k as b,v as h,p as g,q as V,F as L,M as X,I as w,l as _,s as A,_ as y,H as q,G as D,D as U,N as ie,t as C,O as ee,x as k,P as me,Q as _e,R as te,S as qa,T,A as F,U as Kl}from"./index-ByZGjEZk.js";import{_ as j}from"./VDialog.vue_vue_type_style_index_0_lang-DsFvqvJA.js";const I={paletteInputer:"_paletteInputer_1886b6e",palette:"_palette_7ff3ac0",color:"_color_4b3eb95"},we=["for"],xe=["onUpdate:modelValue"],K=e({__name:"PaletteInputter",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:["update:modelValue"],setup(e){const o=u(e,"modelValue"),s=a(!0),n=l(),r=a([]),i=a([]),c=a(),x=a({top:0,zIndex:1}),P=a(null),M=a(null),{start:E}=(()=>{let e=null,l=null;const a=e=>Kl(Math.floor(e.y/100*p(i).length),0,p(i).length-1),o=l=>{F(e)||(x.value.top=l.y-e+"%")};return Q(c,{P:c,we:!1,S:s=>{P.value=a(s),l=100/p(i).length,e=l*(p(P)+.5),o(s)},B:l=>{F(P)||F(e)||(o(l),M.value=a(l))},ke:()=>{if(!F(P)){if(p(P)!==M.value&&!F(M.value)){const e=p(i).splice(p(P),1)[0];p(i).splice(M.value,0,e)}P.value=null,M.value=null,x.value.top=0}}})})(),$=d((()=>({top:p(M)>p(P)?"100%":0}))),B=()=>{n.T(p(s)?p(i):p(r))},G=()=>{n.T(p(i)),R(),_e(o)},R=()=>{r.value=t(n.$,(e=>e.Bt))};m((()=>[p(s),p(i)]),B,{deep:!0}),m(o,(e=>{e?(i.value=t(n.$,(e=>e.Bt)),R(),B()):n.T(p(r))}),{immediate:!0});const S=()=>{p(i).push(te(qa()))};return(e,l)=>(f(),v(j,{overlayProps:{contentClass:p(I).paletteInputer},title:"輸入調色盤",modelValue:o.value,"onUpdate:modelValue":l[4]||(l[4]=e=>o.value=e)},{actions:b((()=>[_(y,{"prepend-icon":"plus",text:"新增",disabled:i.value.length===p(ie),onClick:S},null,8,["disabled"]),l[1]||(C(-1),(l[1]=h("div",{class:"spacer"})).cacheIndex=1,C(1),l[1]),l[2]||(C(-1),(l[2]=h("label",null,[ee(h("input",{type:"checkbox",name:"preview","onUpdate:modelValue":e=>s.value=e},null,8,xe),[[me,s.value]]),l[5]||(l[5]=k(" 預覽 "))])).cacheIndex=2,C(1),l[2]),l[3]||(C(-1),(l[3]=_(y,{text:"確定",onClick:G})).cacheIndex=3,C(1),l[3])])),default:b((()=>[h("div",{ref_key:"contentRef",ref:c,class:g(p(I).palette)},[(f(!0),V(L,null,X(i.value,((e,a)=>(f(),V("div",{key:a,class:g(p(I).color),style:w(a===P.value&&x.value)},[_(y,{icon:"list",onPointerdown:l[0]||(l[0]=e=>p(E)(e))}),h("label",{for:`color${a+1}`,style:w({background:e,color:e})},q(`color${a+1}`),13,we),_(D,{id:`color${a+1}`,modelValue:i.value[a],"onUpdate:modelValue":e=>i.value[a]=e,onPaste:e=>((e,l)=>{var a;const o=(null==(a=e.clipboardData)?void 0:a.getData("text"))??"",s=[];for(const e of o.split("-"))T(e)&&s.push(e.startsWith("#")?e:"#"+e);do{p(i)[l++]=s.shift()}while(l<ie&&s.length)})(e,a)},null,8,["id","modelValue","onUpdate:modelValue","onPaste"]),i.value.length>2?(f(),v(y,{key:0,icon:"x-lg","aria-label":"移除",onClick:e=>{return l=a,void p(i).splice(l,1);var l}},null,8,["onClick"])):A("",!0),a!==P.value&&a===M.value?(f(),v(U,{key:1,style:w($.value),icon:"arrow-left"},null,8,["style"])):A("",!0)],6)))),128))],2)])),_:1},8,["overlayProps","modelValue"]))}});export{K as default};