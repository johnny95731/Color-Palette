import{d as e,m as a,r as o,w as l,o as s,C as n,a as t,H as r,c,h as d,i,b as u,e as m,f as p,g as _,p as f,u as k,j as v,k as h,l as b,n as g,q as y,s as V,t as x,v as F,x as $,y as w,_ as S,F as U,z as C,A as T,B as A,D as M,E as B,G as D,I as E,J as P,K as R,L as j,M as z,N as O,O as G,P as H,Q as q,R as I,S as J,T as K,U as L,V as N,W as Q,X as W,Y as X,Z as Y,$ as Z}from"./index-sXGUyKEX.js";const ee={class:"color-picker__pickers"},ae={class:"color-picker__canvas"},oe={key:0,class:"color-picker__mask"},le={class:"color-picker__edits"},se=["name","max","onUpdate:modelValue"],ne=e({__name:"ColorPicker",props:a({variant:{default:"wheel"}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const a=e,z=o(),O=o(),G=o(),H=o(0),q=()=>{"wheel"===a.variant&&O.value?H.value=P(R(z.value,"--wheel-width")/(2*n),2):H.value=0};l((()=>a.variant),(()=>q()),{flush:"post"}),s((()=>{z.value.style.setProperty("--canvas-size",`${n}px`),q()}));const I=t([0,r[1],r[2]]),J=(e,a=!0)=>{let o="string"==typeof(e=b(e))?j(e):e;a&&(o=o.map((e=>m(e,2)))),Object.assign(I,o)},K=c({get:()=>d(I),set(e){e!==K.value&&i(e)&&J(e)}}),L=c((()=>d([I[0],r[1],r[2]]))),N=t({top:"0",left:"0",background:""}),Q=c((()=>({background:`linear-gradient(0deg, #000, #0000), linear-gradient(90deg, #ffff, #fff0), ${L.value}`}))),W=o({}),X=c((()=>"rect"===a.variant?{o:e=>{I[1]=u(e.x,0,100,0,r[1],2),I[2]=u(e.y,0,100,r[2],0,2)},l:()=>({top:r[2]-I[2]+"%",left:`${I[1]}%`,background:d(I)}),t:e=>{I[0]=m(e,2)},i:()=>({background:L.value})}:"rounded"===a.variant?{o:e=>{const{deg:a,radius:o}=p(u(e.y,0,100,-1,1,4),u(e.x,0,100,-1,1,4));I[0]=_(a+90,360),I[1]=u(o,0,1,0,r[1],2)},l:()=>{const{x:e,y:a}=f(I[1],I[0]-90,2);return{top:`${u(a,-r[1],r[1],0,100,1)}%`,left:`${u(e,-r[1],r[1],0,100,1)}%`,background:d(I)}},t:e=>{I[2]=m(e,2)},i:()=>({background:d([0,0,I[2]])})}:{o:e=>{const{deg:a}=p(u(e.y,0,100,-1,1,4),u(e.x,0,100,-1,1,4),2);I[0]=_(a+90,360)},l:()=>{const{x:e,y:a}=f(50-H.value,I[0]-90);return{top:`${a+50}%`,left:`${e+50}%`,background:L.value}},u:e=>{I[1]=u(e.x,0,100,0,r[1],2),I[2]=u(e.y,0,100,r[2],0,2)},i:()=>({left:`${m(u(I[1],0,r[1],0,100),2)}%`,top:`${m(u(I[2],0,r[2],100,0),2)}%`,background:K.value})})),Y={};s((()=>{var e;const a=null==(e=O.value)?void 0:e.getContext("2d"),o=a.createLinearGradient(0,0,n,0);o.addColorStop(0,"#fff"),o.addColorStop(1,"#fff0"),Y.m=o;const l=a.createLinearGradient(0,0,0,n);l.addColorStop(0,"#0000"),l.addColorStop(1,"#000"),Y.p=l;const s=a.createConicGradient(-Math.PI/2,n/2,n/2),t=["#f00","#ff0","#0f0","#0ff","#00f","#f0f","#f00"];t.forEach(((e,a)=>s.addColorStop(a/(t.length-1),e))),Y._=s}));const Z=()=>{var e;const a=null==(e=O.value)?void 0:e.getContext("2d");a&&a.clearRect(0,0,n,n)},ne=e=>{var a;const o=null==(a=O.value)?void 0:a.getContext("2d");o&&(o.fillStyle=b(e),o.fillRect(0,0,n,n))},te=c((()=>{var e;const o=null==(e=O.value)?void 0:e.getContext("2d");return"rect"===a.variant?()=>{Z(),ne(L),ne(Y.m),ne(Y.p)}:"rounded"===a.variant?()=>{Z(),ne(Y._),ne("#000000"+u(I[2],0,r[2],255,0,0).toString(16));const e=n/2,a=o.createRadialGradient(e,e,0,e,e,e),l=d([0,0,I[2]]);a.addColorStop(0,l),a.addColorStop(1,l+"00"),ne(a)}:(Z(),ne(Y._),null)})),re=()=>{var e;Object.assign(N,X.value.l()),W.value=X.value.i(),null==(e=te.value)||e.call(te)};l((()=>[a.variant,I]),re,{deep:!0,flush:"post"}),s(re),(()=>{const e=e=>{X.value.o(e)};k(O,{containerElement:O,onStart:e,onMove:e})})(),(()=>{const e=e=>{X.value.u(e)};k(G,{containerElement:G,onStart:e,onMove:e})})();const ce=v(e,"modelValue");return h(b(ce))||J(ce,!1),l(I,(e=>{ce.value=e}),{immediate:!0}),l(ce,(e=>J(e)),{deep:!0}),(e,a)=>(g(),y("div",{ref_key:"containerRef",ref:z,class:E(["color-picker",`color-picker--${e.variant}`])},[V("div",ee,[V("div",ae,[a[0]||(x(-1),(a[0]=V("canvas",{ref_key:"canvasPickerRef",ref:O,width:b(n),height:b(n)},null,8,["width","height"])).cacheIndex=0,x(1),a[0]),"wheel"===e.variant?(g(),y("div",oe)):F("",!0),V("div",{class:"color-picker__thumb",style:$(N)},null,4)]),"wheel"!==e.variant?(g(),w(S,{key:0,showRange:!1,min:"0",max:"rect"===e.variant?b(r)[0]:b(r)[2],trackerBackground:"rect"===e.variant?"linear-gradient(to right, #F00, #FF0, #0F0, #0FF, #00F, #F0F, #F00)":"linear-gradient(to right, #000, #fff)",thumbBackground:W.value.background,"model-value":"rect"===e.variant?I[0]:I[2],"onUpdate:modelValue":X.value.t},null,8,["max","trackerBackground","thumbBackground","model-value","onUpdate:modelValue"])):(g(),y("div",{key:1,ref_key:"secondPickerRef",ref:G,class:"color-picker__rect-picker",style:$(Q.value)},[V("div",{class:"color-picker__thumb",rectPickerThumeStyle:"",style:$(W.value)},null,4)],4))]),V("div",le,[(g(),y(U,null,C([["hue","色調"],["sat","彩度"],["bri","亮度"]],(([e,a],o,l,s)=>{const n=[I[o]];if(s&&s.key===e&&T(s,n))return s;const t=(g(),y("label",{key:e},[A(M(a)+" ",1),B(V("input",{name:`color-piker-${e}`,type:"number",inputmode:"decimal",min:"0",max:b(r)[o],step:"any","onUpdate:modelValue":e=>I[o]=e},null,8,se),[[D,I[o],void 0,{lazy:!0}]])]));return t.memo=n,t}),a,1),64))])],2))}}),te=["min","max"],re=((e,a)=>{const o=e.__vccOpts||e;for(const[l,s]of a)o[l]=s;return o})(e({__name:"HarmonyGenDialog",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:["update:modelValue"],setup(e){const a=v(e,"modelValue"),s=z(),n=o([[]]),d=()=>{n.value=s.cards.map((e=>e.color))};l(a,(()=>{O(a)?d():s.setPlt(O(n))}),{immediate:!0});const i=o([0,r[1],r[2]]),u=t({method:0,num:6}),m=c((()=>G(H[u.method])([...O(i)],u.num).map((e=>q(I(e)))))),p=o("wheel"),_=()=>s.setPlt(O(m)),f=()=>{_(),d(),Z(a)};return(e,o)=>(g(),w(Y,{"content-class":e.$style.genDialog,role:"dialog",eager:!0,transition:"slide-y",transparent:"",modelValue:a.value,"onUpdate:modelValue":o[6]||(o[6]=e=>a.value=e)},{default:J((()=>[o[0]||(x(-1),(o[0]=V("header",{class:E(e.$style.header)},[o[7]||(o[7]=V("h2",null,"調和調色盤",-1)),K(L,{icon:"close","aria-label":"close",onClick:e=>a.value=!1},null,8,["onClick"])],2)).cacheIndex=0,x(1),o[0]),V("div",{class:E(e.$style.content)},[V("div",{class:E(e.$style.palette)},[(g(!0),y(U,null,C(m.value,((e,a)=>(g(),y("div",{key:a,style:$({background:e})},null,4)))),128))],2),K(ne,{variant:p.value,modelValue:i.value,"onUpdate:modelValue":o[1]||(o[1]=e=>i.value=e)},null,8,["variant","modelValue"]),K(N,{options:["rect","rounded","wheel"],modelValue:p.value,"onUpdate:modelValue":o[2]||(o[2]=e=>p.value=e)},null,8,["modelValue"]),K(N,{options:b(H),index:u.method,"onUpdate:index":o[3]||(o[3]=e=>u.method=e)},null,8,["options","index"]),1<=u.method&&u.method<=3?Q([u],(()=>(g(),y("div",{key:0,class:E(e.$style.numbers)},[o[8]||(o[8]=V("label",{for:"harmony-num"},"數量",-1)),B(V("input",{id:"harmony-num",name:"harmony-num",type:"number",min:b(W),max:b(X),"onUpdate:modelValue":o[4]||(o[4]=e=>u.num=e)},null,8,te),[[D,u.num,void 0,{lazy:!0,number:!0}]])],2))),o,5):F("",!0),o[9]||(o[9]=V("div",{class:"spacer"},null,-1))],2),V("div",{class:E(e.$style.buttons)},[K(L,{onClick:_},{default:J((()=>o[10]||(o[10]=[A(" 預覽 ")]))),k:1}),K(L,{onClick:f},{default:J((()=>o[11]||(o[11]=[A(" 確定 ")]))),k:1})],2)])),k:1},8,["content-class","modelValue"]))}}),[["__cssModules",{$style:{color1:"#FAFAFA",color2:"#EAEAEA",color3:"#C0C0C0",color4:"#707070",color5:"#1D1D57",genDialog:"_genDialog_bos2o_9",header:"_header_bos2o_20",content:"_content_bos2o_44",palette:"_palette_bos2o_53",numbers:"_numbers_bos2o_68",buttons:"_buttons_bos2o_79"}}]]);export{re as default};
