import{d as a,e as c,r as e,u as s,K as N,c as n,b as m,w as r,L as oe,h as f,o as x,j as g,q as D,l as h,m as y,F as U,D as B,H as P,k as v,p as V,_ as b,B as M,z as w,N as F,O as me,s as k,y as j,t as C,P as _e,Q as fe,J as q,R as ne,S as mc,T as Mc,U as Sc,V as W,W as ka}from"./index-Dh8Jem8x.js";import{_ as I}from"./VDialog.vue_vue_type_style_index_0_lang-D8oQI4U4.js";const A={paletteInputer:"_paletteInputer_93a2890",palette:"_palette_4044008",color:"_color_efb6a10"},Re=["for"],He=["id","value","onChange","onKeydown"],ye=["onUpdate:modelValue"],H=a({__name:"paletteInputer",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:["update:modelValue"],setup(a){const l=c(a,"modelValue"),o=e(!0),t=s(),i=e([]),u=e([]),d=e(),p=e({top:0,zIndex:1}),_=e(null),z=e(null),{start:K}=(()=>{let e=null,a=null;const l=e=>ka(Math.floor(e.y/100*m(u).length),0,m(u).length-1),o=a=>{W(e)||(p.value.top=a.y-e+"%")};return N(d,{U:d,re:!1,C:n=>{_.value=l(n),a=100/m(u).length,e=a*(m(_)+.5),o(n)},P:a=>{W(_)||W(e)||(o(a),z.value=l(a))},ie:()=>{if(!W(_)){if(m(_)!==z.value&&!W(z.value)){const e=m(u).splice(m(_),1)[0];m(u).splice(z.value,0,e)}_.value=null,z.value=null,p.value.top=0}}})})(),$=n((()=>({top:m(z)>m(_)?"100%":0}))),E=()=>{t.B(m(o)?m(u):m(i))},J=()=>{t.B(m(u)),Q(),fe(l)},Q=()=>{i.value=oe(t.T,(e=>e.yt))};r((()=>[m(o),m(u)]),E,{deep:!0}),r(l,(e=>{e?(u.value=oe(t.T,(e=>e.yt)),Q(),E()):t.B(m(i))}),{immediate:!0});const R=()=>{m(u).push(ne(mc()))};return(e,a)=>(x(),f(I,{overlayProps:{contentClass:m(A).paletteInputer},title:"輸入調色盤",modelValue:l.value,"onUpdate:modelValue":a[5]||(a[5]=e=>l.value=e)},{actions:g((()=>[v(b,{"prepend-icon":"plus",text:"新增",disabled:u.value.length===m(me),onClick:R},null,8,["disabled"]),a[2]||(k(-1),(a[2]=D("div",{class:"spacer"})).cacheIndex=2,k(1),a[2]),a[3]||(k(-1),(a[3]=D("label",null,[j(D("input",{type:"checkbox",name:"preview","onUpdate:modelValue":e=>o.value=e},null,8,ye),[[_e,o.value]]),a[6]||(a[6]=C(" 預覽 "))])).cacheIndex=3,k(1),a[3]),a[4]||(k(-1),(a[4]=v(b,{text:"確定",onClick:J})).cacheIndex=4,k(1),a[4])])),default:g((()=>[D("div",{ref_key:"contentRef",ref:d,class:h(m(A).palette)},[(x(!0),y(U,null,B(u.value,((e,l)=>(x(),y("div",{key:l,class:h(m(A).color),style:P(l===_.value&&p.value)},[v(b,{icon:"list",onPointerdown:a[0]||(a[0]=e=>m(K)(e))}),D("label",{for:`color${l+1}`,style:P({background:e,color:e})},M(`color${l+1}`),13,Re),D("input",{id:`color${l+1}`,maxlength:"7",size:"7",value:e,onInput:a[1]||(a[1]=e=>m(w)(e)),onChange:e=>function(e,a){const l=e.currentTarget.value;l!==m(u)[a]&&q(l)&&(m(u)[a]=l)}(e,l),onKeydown:e=>(async(e,a)=>{if(Mc(e)&&"v"===e.key.toLowerCase()){const e=await Sc();if(e){const l=[];for(const a of e.split("-"))q(a)&&l.push(a.startsWith("#")?a:"#"+a);do{m(u).splice(a++,1,l.shift())}while(a<me&&l.length);a<m(u).length&&m(u).splice(a,m(u).length-a)}}})(e,l)},null,40,He),u.value.length>2?(x(),f(b,{key:0,icon:"x-lg","aria-label":"移除",onClick:e=>{return a=l,void m(u).splice(a,1);var a}},null,8,["onClick"])):V("",!0),l!==_.value&&l===z.value?(x(),f(F,{key:1,style:P($.value),type:"arrow-left"},null,8,["style"])):V("",!0)],6)))),128))],2)])),_:1},8,["overlayProps","modelValue"]))}});export{H as default};